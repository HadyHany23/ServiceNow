<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
  <script>
    // ===============================
    // Library Management System
    // Console Version
    // ===============================

    let library = [];

    // ===============================
    // Start System (Main Menu)
    // ===============================
    function startLibrary() {
      let choice;

      do {
        choice = prompt(
          "üìö Library Management System\n\n" +
            "1 ‚Üí Add New Book\n" +
            "2 ‚Üí Borrow Book\n" +
            "3 ‚Üí Return Book\n" +
            "4 ‚Üí Show Library Report\n" +
            "5 ‚Üí Exit\n\n" +
            "Enter your choice:",
        );

        switch (choice) {
          case "1":
            addBook();
            break;
          case "2":
            borrowBook();
            break;
          case "3":
            returnBook();
            break;
          case "4":
            showReport();
            break;
          case "5":
            alert("Exiting system... Goodbye üëã");
            break;
          default:
            alert("Invalid choice! Please try again.");
        }
      } while (choice !== "5");
    }

    // ===============================
    // Function 1 ‚Äî Add Book
    // ===============================
    function addBook() {
      let title = prompt("Enter Book Title:");

      if (!title || title.trim() === "") {
        alert("‚ùå Book title cannot be empty!");
        return;
      }

      let author = prompt("Enter Author Name:");
      let copies = parseInt(prompt("Enter Number of Copies:"));

      if (isNaN(copies) || copies <= 0) {
        alert("‚ùå Copies must be a number greater than 0!");
        return;
      }

      // Case insensitive duplicate check
      let existingBook = library.find(
        (book) => book.title.toLowerCase() === title.toLowerCase(),
      );

      if (existingBook) {
        existingBook.availableCopies += copies;
        alert("üìò Book already exists. Copies updated successfully!");
      } else {
        library.push({
          title: title,
          author: author,
          availableCopies: copies,
          borrowedCopies: 0,
          borrowCount: 0,
        });
        alert("‚úÖ Book added successfully!");
      }
    }

    // ===============================
    // Function 2 ‚Äî Borrow Book
    // ===============================
    function borrowBook() {
      let title = prompt("Enter Book Title to Borrow:");

      let book = library.find(
        (book) => book.title.toLowerCase() === title.toLowerCase(),
      );

      if (!book) {
        alert("‚ùå Book not found!");
        return;
      }

      if (book.availableCopies <= 0) {
        alert("‚ö† No available copies! Book is Out of Stock.");
        return;
      }

      book.availableCopies--;
      book.borrowedCopies++;
      book.borrowCount++;

      alert("üìñ Book borrowed successfully!");
    }

    // ===============================
    // Function 3 ‚Äî Return Book
    // ===============================
    function returnBook() {
      let title = prompt("Enter Book Title to Return:");

      let book = library.find(
        (book) => book.title.toLowerCase() === title.toLowerCase(),
      );

      if (!book) {
        alert("‚ùå Book not found!");
        return;
      }

      if (book.borrowedCopies > 0) {
        book.availableCopies++;
        book.borrowedCopies--;
        alert("üîÑ Book returned successfully!");
      } else {
        alert("‚ö† No borrowed copies to return.");
      }
    }

    // ===============================
    // Function 4 ‚Äî Calculate Totals
    // ===============================
    function calculateTotalBooks() {
      let totalAvailable = 0;
      let totalBorrowed = 0;

      library.forEach((book) => {
        totalAvailable += book.availableCopies;
        totalBorrowed += book.borrowedCopies;
      });

      return { totalAvailable, totalBorrowed };
    }

    // ===============================
    // Book Status Classification
    // ===============================
    function getStatus(book) {
      if (book.availableCopies > 2) return "Available";
      if (book.availableCopies >= 1) return "Limited";
      return "Out of Stock";
    }

    // ===============================
    // Function 5 ‚Äî Show Report
    // ===============================
    function showReport() {
      if (library.length === 0) {
        console.log("üìö No books in library.");
        alert("No books in library. Check console.");
        return;
      }

      console.clear();
      console.log("========== üìö Library Report ==========\n");

      library.forEach((book, index) => {
        console.log(`Book ${index + 1}`);
        console.log(`Title: ${book.title}`);
        console.log(`Author: ${book.author}`);
        console.log(`Available Copies: ${book.availableCopies}`);
        console.log(`Borrowed Copies: ${book.borrowedCopies}`);
        console.log(`Total Times Borrowed: ${book.borrowCount}`);
        console.log(`Status: ${getStatus(book)}`);
        console.log("----------------------------------");
      });

      let totals = calculateTotalBooks();

      console.log("\n========== üìä Totals ==========");
      console.log(`Total Available Books: ${totals.totalAvailable}`);
      console.log(`Total Borrowed Books: ${totals.totalBorrowed}`);
      console.log("=================================\n");

      alert("Library report displayed in console.");
    }
  </script>
</html>
